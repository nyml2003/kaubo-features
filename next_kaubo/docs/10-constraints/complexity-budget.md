# 复杂度预算（维护负担上限）

项目是个人维护，复杂度必须可控。

## 硬性限制

| 维度 | 上限 | 当前 | 状态 |
|------|------|------|------|
| 核心代码行数（不含测试） | 10,000行 | 约3,000 | 🟢 健康 |
| 外部依赖数量（运行时） | 5个 | 待统计 | 🟡 未知 |
| unsafe代码块数量 | 20个 | 待统计 | 🟡 未知 |
| 架构层级 | 4层 | 4层 | 🟢 健康 |
| 同时维护的语法版本 | 1个 | 1个 | 🟢 健康 |

## 不做的事情（节省复杂度预算）

以下功能**当前明确不做**，除非有强理由：

| 功能 | 不做原因 | 如果要做，需要什么条件 |
|------|---------|---------------------|
| 完整GC | 实现复杂度>收益，Arena足够 | 需要支持>1小时长运行且内存分析证明泄漏严重 |
| 多线程并行 | 单线程足够，引入竞态复杂度 | 实测性能瓶颈在CPU且单核满载 |
| 跨平台支持 | 优先主力平台，移植成本>收益 | 主力平台稳定且移植需求真实出现 |
| 包管理器 | 个人项目直接复制文件更简单 | 项目数量>10个且依赖管理成为痛点 |
| IDE/LSP协议 | 文本编辑器+简单插件足够 | 作者日常开发受限于编辑器支持 |
| 调试协议（DAP） | print+热重载足够 | 复杂bug无法通过热重载定位 |
| 协程并发 | async/await引入复杂度，可用回调 | 回调模式导致代码难以维护 |
| 宏系统 | 语法糖足够，宏增加理解成本 | 重复模式反复出现且无法语法解决 |

## 调整记录

| 日期 | 调整内容 | 原因 |
|------|---------|------|
| （空） | | |

## 注释

- 核心代码行数统计：`find src -name "*.rs" | xargs wc -l`
- unsafe块统计：`grep -r "unsafe" src --include="*.rs" | wc -l`
- 超过预算时必须删除旧功能或简化现有功能，不能只增加
